import numpy as np
import qulacs
import re
from qibo.backends import NumpyBackend


gates = {

}


class QulacsBackend(NumpyBackend):

    def __init__(self):
        super().__init__()
        self.name = "qulacs"
        self.versions = {"qibo": __version__, "qulacs": qulacs.__version__}

    def circuit_to_qulacs(self, circuit: "qibo.Circuit") -> qulacs.QuantumCircuit:
        qasm_str = re.sub("^//.+\n", "", circuit.to_qasm())
        return qulacs.converter.convert_QASM_to_qulacs_circuit(circuit)

    def execute_circuit(self, circuit: "qibo.Circuit", initial_state: np.ndarray=None, nshots: int=1000):
        return super().execute_circuit(self.circuit_to_qulacs(circuit), initial_state, nshots)
